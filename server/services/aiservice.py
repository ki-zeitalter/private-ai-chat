from flask import Response
import time
import json


class AIService:

    def __init__(self, history_service, model_service):
        self.history_service = history_service
        self.model_service = model_service

    def chat(self, body, user_id, thread_id):
        # Text messages are stored inside request body using the Deep Chat JSON format:
        # https://deepchat.dev/docs/connect
        # print(body)
        # Sends response back to Deep Chat using the Response format:
        # https://deepchat.dev/docs/connect/#Response

        # Save the message to the history
        messages = body["messages"]
        self.history_service.add_history(user_id, thread_id, messages)

        result = self.model_service.chat(body)

        print(result)
        messages.append({'role': 'ai', 'text': result['text']})
        self.history_service.add_history(user_id, thread_id, messages)

        return result

    def chat_stream(self, body, user_id, thread_id):
        # Text messages are stored inside request body using the Deep Chat JSON format:
        # https://deepchat.dev/docs/connect
        print(body)
        # Save the message to the history
        messages = body["messages"]
        self.history_service.add_history(user_id, thread_id, messages)

        def callback(response):
            messages.append({'role': 'ai', 'text': response})
            self.history_service.add_history(user_id, thread_id, messages)

        return self.model_service.chat_stream(body, callback)

    def text_to_image(self, body, user_id, thread_id):
        return self.model_service.text_to_image(body)

        # result = "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"
        # return {"files": [{"type": "image", "src": "data:image/png;base64," + result}]}

    def files(self, request):
        # Files are stored inside a files object
        # https://deepchat.dev/docs/connect

        # Sends response back to Deep Chat using the Response format:
        # https://deepchat.dev/docs/connect/#Response
        return {"text": "This is a response from a Flask server. Thankyou for your message!"}
